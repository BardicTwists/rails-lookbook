{"mappings":"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","sources":["app/assets/lookbook/js/lookbook-core.js","app/assets/lookbook/js/lib/lookbook.js"],"sourcesContent":["import \"./lib/lookbook\";\n","window.Lookbook = window.Lookbook || {};\nwindow.Lookbook.initEmbeds = initEmbeds;\n\nconst embedUrlPrefix = \"embed\";\nconst whiteListedAttributes = [\n  \"preview\",\n  \"scenario\",\n  \"panels\",\n  \"actions\",\n  \"param-*\",\n];\n\nfunction initEmbeds() {\n  if (typeof window.iFrameResize !== \"function\") {\n    console.error(\n      \"Lookbook embeds require the 'iframe-resizer' library to be available. Skipping embed instantiation.\"\n    );\n    return;\n  }\n\n  const embeds = Array.from(document.querySelectorAll(\"lookbook-embed\"));\n\n  embeds.forEach((embed) => {\n    const attrs = Array.from(embed.attributes);\n    const wrapper = createWrapper();\n    const iframe = createIframe(attrs);\n\n    wrapper.appendChild(iframe);\n    embed.replaceWith(wrapper);\n  });\n\n  window.iFrameResize({ checkOrigin: false }, \"[data-lookbook-embed-iframe]\");\n}\n\nfunction createWrapper() {\n  const wrapper = document.createElement(\"div\");\n\n  wrapper.setAttribute(\"data-lookbook-embed\", true);\n  wrapper.classList.add(\"lookbook-embed\");\n\n  return wrapper;\n}\n\nfunction createIframe(attrs) {\n  const src = buildSrc(attrs);\n  const id = attrValue(attrs, \"id\");\n  const styles = attrValue(attrs, \"style\");\n  const classes = attrValue(attrs, \"class\", \"\")\n    .split(\" \")\n    .map((c) => c.trim())\n    .filter((c) => c.length);\n\n  const iframe = document.createElement(\"iframe\");\n  iframe.src = src;\n  if (id) iframe.id = id;\n\n  iframe.setAttribute(\"frameborder\", 0);\n  iframe.setAttribute(\"data-lookbook-embed-iframe\", true);\n\n  if (classes.length) iframe.classList.add(...classes);\n  if (styles) iframe.style.cssText = styles;\n\n  iframe.style.width = \"100%\";\n  iframe.style.transition = \"height 0.3s\";\n\n  return iframe;\n}\n\nfunction buildSrc(attrs) {\n  const appPath = attrValue(attrs, \"app\") || guessBasePath();\n  const props = {};\n\n  permittedAttrs(attrs).forEach(({ name, value }) => {\n    console.log(name, value);\n    name = name.replace(\"-\", \"_\").toLowerCase();\n    props[name] = value;\n  });\n\n  return encodeURI(\n    [appPath, embedUrlPrefix].join(\"/\") + `?props=${JSON.stringify(props)}`\n  );\n}\n\nfunction attrValue(attrs, name, fallback = null) {\n  const attr = attrs.find((attr) => attr.name === name);\n  return attr ? attr.value : fallback;\n}\n\nfunction permittedAttrs(attrs) {\n  return attrs.filter((attr) => {\n    return whiteListedAttributes.find((key) => {\n      const name = attr.name;\n      return (\n        key === name ||\n        (key.includes(\"*\") && name.startsWith(key.replace(\"*\", \"\")))\n      );\n    });\n  });\n}\n\nfunction guessBasePath() {\n  const script =\n    document.currentScript ||\n    document.querySelector('script[src*=\"lookbook.js\"]');\n  const scriptSrc = script.src;\n\n  if (scriptSrc && scriptSrc.includes(\"lookbook-assets\")) {\n    return scriptSrc.replace(\"lookbook-assets/js/lookbook.js\", \"lookbook\");\n  }\n\n  return `//${location.host}/lookbook`;\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => initEmbeds());\n"],"names":[],"version":3,"file":"lookbook-core.js.map"}